---

- include_vars: "{{ ansible_distribution }}.yml"

- name: Add duplicity repository
  apt_repository:
    repo: ppa:duplicity-team/ppa
    state: present
    update_cache: yes
  when: backup_duplicity_ppa

- name: Install dependencies
  apt:
    name:
    - cron
    - gzip
    - python-boto
    - s3cmd
    - duply

- set_fact: backup_duplicity_pkg="{{ backup_duplicity_pkg }}={{ backup_duplicity_version }}"
  when: backup_duplicity_version

- name: Install duplicity
  apt: pkg={{ backup_duplicity_pkg }} state=present
